<nav class="navbar" *ngIf="showNavbar">
  <div class="nav-left" (click)="goHome()">
    <h1 class="logo">ğŸŒ¾ Farm-Bridge</h1>
  </div>

  <div class="nav-right" *ngIf="user">
    <!-- Dealer Links -->
    <ng-container *ngIf="user.role === 'DEALER'">
      <a routerLink="/dealer/crops" routerLinkActive="active" class="nav-link">ğŸŒ¾ Crops</a>
      <a routerLink="/dealer/cart" routerLinkActive="active" class="nav-link">
        ğŸ›’ Cart <span *ngIf="cartCount">({{ cartCount }})</span>
      </a>
      <a routerLink="/dealer/requests" routerLinkActive="active" class="nav-link">ğŸ“‹ Requests</a>
    </ng-container>

    <!-- Farmer Links -->
    <ng-container *ngIf="user.role === 'FARMER'">
      <a routerLink="/farmer" class="nav-link">ğŸŒ± My Crops</a>
      <a routerLink="/farmer/requests" class="nav-link">ğŸ“© Requests</a>
    </ng-container>

    <!-- Admin Links -->
    <ng-container *ngIf="user.role === 'ADMIN'">
      <a routerLink="/admin/crops" class="nav-link">ğŸŒ¾ Manage Crops</a>
      <a routerLink="/admin/payments" class="nav-link">ğŸ’° Payments</a>
    </ng-container>

    <!-- Visible Logout link (right side) -->
    <button class="nav-link" (click)="logout()" title="Logout">ğŸšª Logout</button>

    <!-- Profile Dropdown -->
    <div class="profile-container" (click)="toggleDropdown()">
      <span class="username">{{ user.email?.split('@')[0] || 'User' }}</span>
      <span
        class="role-badge"
        [class.admin]="user.role === 'ADMIN'"
        [class.dealer]="user.role === 'DEALER'"
        [class.farmer]="user.role === 'FARMER'">
        {{ user.role }}
      </span>
      <i class="material-icons arrow" [class.open]="dropdownOpen">expand_more</i>

      <div class="dropdown-menu" *ngIf="dropdownOpen" style="display: flex;">
        <button (click)="viewProfile()">ğŸ‘¤ View Profile</button>
        <!-- keep logout here as well as a fallback -->
        <button (click)="logout()">ğŸšª Logout</button>
      </div>
    </div>
  </div>
</nav>
