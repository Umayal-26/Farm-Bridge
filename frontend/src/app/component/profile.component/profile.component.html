<div class="profile-page">
  <div class="profile-card" *ngIf="user">
    <div class="profile-header">
      <h2>ğŸ‘¤ {{ user.name || user.email?.split('@')[0] }}</h2>
      <span
        class="role-badge"
        [class.admin]="user.role === 'ADMIN'"
        [class.dealer]="user.role === 'DEALER'"
        [class.farmer]="user.role === 'FARMER'"
      >
        {{ user.role }}
      </span>
    </div>

    <form *ngIf="editMode; else viewMode" (ngSubmit)="saveProfile()" class="edit-form">
      <label>
        <strong>Name:</strong>
        <input [(ngModel)]="updatedUser.name" name="name" required />
      </label>

      <label>
        <strong>Role:</strong>
        <select [(ngModel)]="updatedUser.role" name="role" required>
          <option *ngFor="let role of roles" [value]="role">{{ role }}</option>
        </select>
      </label>

      <div class="edit-buttons">
        <button type="submit" [disabled]="loading">ğŸ’¾ Save</button>
        <button type="button" (click)="cancelEdit()">âŒ Cancel</button>
      </div>

      <p class="status-message" [class.success]="message.startsWith('âœ…')" [class.error]="message.startsWith('âŒ')">
        {{ message }}
      </p>
    </form>

    <ng-template #viewMode>
      <div class="profile-details">
        <p><strong>Email:</strong> {{ user.email }}</p>
        <p><strong>Provider:</strong> {{ user.provider || 'LOCAL' }}</p>
        <p><strong>Account ID:</strong> {{ user.userId || user.id || 'â€”' }}</p>
        <p><strong>Status:</strong> <span class="status">Active âœ…</span></p>
      </div>

      <div class="profile-actions">
        <button class="edit-btn" (click)="enableEdit()">âœï¸ Edit Profile</button>
        <button class="back-btn" (click)="goBack()">â¬… Back</button>
      </div>
    </ng-template>
  </div>
</div>
